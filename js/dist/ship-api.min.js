!function(a){"use strict";a.fn.shipApi=function(b){var c=a.extend({url:"https://api.laiva-api.pw/v1",size:10},b);a(this).html(renderShipApiSearchControls());var d=0,e=0,f="",g=a(this);c.prevSearches&&a(this).find(".ship-api-previous-searches").append(c.prevSearches),g.on("ship-select",function(a,b,d){"function"==typeof c.onShipSelect&&c.onShipSelect(b,d)}),g.on("before-search",function(a,b){"function"==typeof c.beforeSearch&&c.beforeSearch(b)}),g.on("after-search",function(a,b){"function"==typeof c.afterSearch&&c.afterSearch(b)});var h=a(this).find(".main-search-input");if(h.length<1)throw new Error("Search input field missing, is your theme ok?");var i=a(this).find(".main-search-results");if(i.length<1)throw new Error("Search results container missing, is your theme ok?");var j=a(this).find(".ship-api-load-container");if(j.length<1)throw new Error("Load container missing, is your theme ok?");var k=a(this).find(".main-search-btn");if(k.length<1)throw new Error("Search button missing, is your theme ok?");var l=function(){g.trigger("before-search",{query:f,offset:d,size:c.size}),i.hide(),j.show(),a.getJSON(c.url+"/ships?q="+f+"&from="+d+"&size="+c.size,function(b){e=b.hits.total;for(var f=[],h=0;h<b.hits.hits.length;h++){var k=b.hits.hits[h];k._source._id=k._id,f.push(k._source)}i.html(renderShipApiSearchresults({ships:f,offset:d,size:c.size,total:e})),j.hide(),i.show(),i.find(".prev-page").click(function(a){a.preventDefault(),d-=c.size,l()}),i.find(".next-page").click(function(a){a.preventDefault(),d+=c.size,l()}),i.find(".goto-page").click(function(b){b.preventDefault(),d=parseInt(a(this).attr("data-offset"),10),l()}),i.find(".searchresult").click(function(){var b=a(this).attr("data-ship-id");a(this).attr("data-ship-name");a.getJSON(c.url+"/ships/"+b,function(a){g.trigger("ship-select",[a,renderShipApiDetailModal({ship:a})])})})}),g.trigger("after-search",{query:f,offset:d,size:c.size})};g.on("find-ships",function(a,b){h.val(b),k.click()}),g.on("set-prev-searches",function(a,b){g.find(".ship-api-previous-searches").empty(),g.find(".ship-api-previous-searches").append(b)}),k.click(function(){f=h.val(),d=0,l()}),h.keyup(function(a){13==a.keyCode&&k.click()})}}(jQuery);